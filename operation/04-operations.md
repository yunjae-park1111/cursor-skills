# 4. 운영 및 장애 대응

## 개요

일상 운영 점검 및 백업 항목과 장애 발생 시 대응 및 복구 절차를 정의한다.

---

## 일상 운영

### 1. 모니터링

- **ArgoCD Dashboard**
    - Application Sync 상태
    - Health Status
    - 배포 히스토리
- **Git Workflow**
    - 배포 파이프라인 동작 상태
- **Slack**
    - 배포 파이프라인 알람

### 2. 정기 점검

**일일 점검 (평일)**

- [ ] 개발 서버 자동 배포 결과 확인
- [ ] ArgoCD Sync 상태 확인
- [ ] Slack 알림 이력 검토

**주간 점검 (스프린트 회고)**

- [ ] 주간 배포 현황 리뷰
- [ ] 배포 이슈 회고

### 3. 유지보수

- Helm Chart 버전 업그레이드 (필요 시)
- 문서 업데이트

### 4. 백업

**현재 상태**

- 백업 정책 미수립

**향후 계획**

- 백업 대상: PostgreSQL
- ArgoCD Application, ConfigMap은 Git에서 버전 관리

---

## 장애 대응

### 1. 롤백 정책

- 배포 실패 시 자동 롤백하지 않음
- 실패 상태 유지하여 원인 분석 후 수정 배포
- 필요 시 수동 롤백
    - Prod의 경우, 이전 버전으로 자동 롤백

### 2. 핫픽스 전략

| 환경 | 전략 |
|------|------|
| 개발/스테이지 | 수정 후 재배포 (seq 자동 증가) |
| 프로덕션 | patch 버전 증가 후 배포 |

### 3. 알림

- **채널**: Slack (CI/CD List + DM)
- **이벤트**: 배포 시작/완료, 빌드 실패, Sync 실패

### 4. 장애 등급

| 등급 | 정의 | 대응 시간 |
|------|------|-----------|
| P0 | 배포 프로세스 중단 | 즉시 |
| P1 | 일부 기능 오류 | 4시간 이내 |
| P2 | 경미한 문제 | 익일 |

### 5. 대응 프로세스

1. Slack 알림 수신
2. 등급 분류 및 원인 분석
3. Hot Fix 또는 수동 롤백
    - Prod는 이전 버전으로 자동 롤백
4. 검증 및 사후 분석

### 6. 재해 복구

- 복원 정책 미수립

**클러스터 레벨 장애**

1. ArgoCD Application 매니페스트 확인
2. 새 클러스터에 ArgoCD 설치
3. Git Repository에서 Application 설정 복원
4. ArgoCD Sync 실행
5. 서비스 정상 동작 확인

**애플리케이션 레벨 장애**

1. 최근 안정 버전 태그 확인
2. ArgoCD에서 해당 버전으로 롤백
3. 테스트 실행
